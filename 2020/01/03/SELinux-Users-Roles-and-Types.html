<!doctype html><html lang=en>
<head>
<meta charset=utf-8>
<title>SELinux Users, Roles, and Types</title>
<meta name=viewport content="width=device-width,initial-scale=1">
<meta name=description content>
<meta name=generator content="Hugo 0.87.0">
<link href rel=alternate type=application/rss+xml title=Kabads>
<link href=https://kabads.monkeez.org/css/bootstrap.min.css rel=stylesheet>
<link href=https://kabads.monkeez.org/css/hc.css rel=stylesheet>
<link href=//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css rel=stylesheet>
<script type=text/javascript>var owa_baseUrl='https://home.monkeez.org/owa/',owa_cmds=owa_cmds||[];owa_cmds.push(['setDebug',!0]),owa_cmds.push(['setSiteId','e96cc79fe81df249b3191b2c920fa8f7']),owa_cmds.push(['trackPageView']),owa_cmds.push(['trackClicks']),function(){var a=document.createElement('script'),b;a.type='text/javascript',a.async=!0,owa_baseUrl='https:'==document.location.protocol?window.owa_baseSecUrl||owa_baseUrl.replace(/http:/,'https:'):owa_baseUrl,a.src=owa_baseUrl+'modules/base/js/owa.tracker-combined-min.js',b=document.getElementsByTagName('script')[0],b.parentNode.insertBefore(a,b)}()</script>
</head>
<body>
<div class=nav-toggle><i class="fa fa-bars fa-2x"></i> Herring Cove </div>
<div id=wrapper>
<div class="navbar navbar-default" role=navigation>
<div class=container>
<div class=navbar-header>
<button type=button class=navbar-toggle data-toggle=collapse data-target=.navbar-collapse>
<span class=sr-only>Toggle navigation</span>
<span class=icon-bar></span>
<span class=icon-bar></span>
<span class=icon-bar></span>
</button>
<a href=https://kabads.monkeez.org/><p class=navbar-brand>Kabads</p></a>
</div>
<div class="navbar-collapse collapse">
<ul class="nav navbar-nav">
</ul>
</div>
</div>
</div>
<div id=sidebar-wrapper>
<ul class=sidebar-nav>
<img src>
<li class=sidebar-brand><a href=https://kabads.monkeez.org/><h1 class=brand>Kabads</h1></a><h3></h3></li>
<hr>
<li class=sidebar-brand><a href=../../../about>About</a> </li>
<hr>
<p>
<a href=../../../categories/sysadmin>Sysadmin</a> |
<a href=../../../categories/reading>Reading</a> |
<a href=../../../categories/cycling>Cycling</a> |
<a href=../../../categories/ruby>Ruby</a> |
<a href=../../../categories/emacs>Emacs</a> |
<a href=../../../categories/exercise>Exercise</a> |
<a href=../../../categories/tech>Tech</a> |
<a href=../../../categories/education>Education</a> |
<a href=../../../categories/politics>Politics</a>
</p>
<hr>
<p>To contact, PM me via twitter:</p>
<p><a href=https://twitter.com/kabads>Kabads</a></p>
<hr>
<div id=social-wrapper>
</div>
</ul>
</div>
<div class=container>
<div id=article>
<div class=article-title>SELinux Users, Roles, and Types</div>
<p class=meta><small>&nbsp;<i class="fa fa-calendar-o"></i> 2020-01-03</small></p> <hr>
<div class=post>
<p>SELinux contexts follow the SELinux user:role:type:level syntax.</p>
<h3 id=users>Users</h3>
<p>Users can be seen with the command:</p>
<pre tabindex=0><code>semanage user -l</code></pre>
<p>This will show the list of SELinux users, and is mapped to Linux users. If a Linux user is not listed then they are associated with the <code>__default__</code> SELinux user and inherit those rights.</p>
<h3 id=roles>Roles</h3>
<p>Role based access control is a go-between from the user to the domain. By assigning roles, a user can access particular domains. This determines which domains can be accessed by the SELinux user. The role dictates what domains (types, or contexts) it is possible to be in.</p>
<p>To find out which domains (roles) a user is approved for:</p>
<pre tabindex=0><code>seinfo -ruser_r -x </code></pre>
<p>Users can switch roles if they want. However, they can only do this if their SELinux is allowed to be in that role. You can check if this is allowed with:</p>
<pre tabindex=0><code>semanage user -l</code></pre>
<p>This will list a user and the roles that they are allowed to switch to. Obviously for this to work, the Linux user has to have the corresponding SELinux username when they issue <code>id -Z</code>.</p>
<h3 id=type>Type</h3>
<p>The type is an attribute of Type Enforcement. The type defines a domain for processes, and a type for files. SELinux policy rules define how types can access each other, whether it be a domain accessing type, or a domain accessing another domain. Usually types are defined by the suffix <code>_t</code>. Rather than have many many rules which identify the access between actor and object (e.g. user and file), SELinux has a label attached to each actor and object, which specifies whether the actor is allowed access to the object. The rule specifies if the actor has a label that allows access to the objects (with that label).</p>
<h3 id=domains>Domains</h3>
<p>In SELinux labels assigned to a process is also called a <code>domain</code>. An example of an SELinux domain is <code>system_u:system_r:named_t</code>, although that is often reduced to just the type-part, i.e. <code>named_t</code>.</p>
<h3 id=conclusion>Conclusion</h3>
<p>This table represents the structure of a label:</p>
<p><code>system_u:object_r:lib_t</code> associates with an actor <code>user_u:user_r:user_t</code> in the following way:</p>
<table class=table>
<thead>
<tr>
<th><code>system_u</code></th>
<th><code>object_r</code></th>
<th><code>lib_t</code></th>
</tr>
</thead>
<tbody>
<tr>
<td>SELinux User</td>
<td>SELinux Role</td>
<td>SELinux Type</td>
</tr>
<tr>
<td>----------------</td>
<td>---------------</td>
<td>-------------</td>
</tr>
<tr>
<td><code>user_u</code></td>
<td><code>user_r</code></td>
<td><code>user_t</code></td>
</tr>
</tbody>
</table>
</div>
</div>
<a href=https://twitter.com/share class=twitter-share-button data-size=small data-count=none>Tweet</a>
<script>!function(a,c,d){var b,e=a.getElementsByTagName(c)[0],f=/^http:/.test(a.location)?'http':'https';a.getElementById(d)||(b=a.createElement(c),b.id=d,b.src=f+'://platform.twitter.com/widgets.js',e.parentNode.insertBefore(b,e))}(document,'script','twitter-wjs')</script>
<ul class=pager>
&nbsp;<li class=previous><a href=https://kabads.monkeez.org/draft/2019-12-30-selinux.html> SELinux Permissions</a></li>
&nbsp;<li class=next><a href=https://kabads.monkeez.org/2020/03/19/Rsyslog-configured-to-monitor-journald-/run/systemd/journal/syslog-socket.html> Rsyslog configured to monitor journald /run/systemd/journal/syslog socket</a></li>
</ul>
</ul>
</div>
<footer>
<p class="text-muted credit">&copy; 2021. All rights reserved. </p>
</footer>
<script src=https://kabads.monkeez.org/js/jquery-1.10.2.min.js></script>
<script src=https://kabads.monkeez.org/js/bootstrap.min.js></script>
<script src=https://kabads.monkeez.org/js/bootstrap.js></script>
<script type=text/javascript src=https://kabads.monkeez.org/js/hc.js></script>
</body>
</html>