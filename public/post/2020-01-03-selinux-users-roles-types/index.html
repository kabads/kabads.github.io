<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>SELinux Users, Roles, and Types</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="">
  <meta name="generator" content="Hugo 0.82.0" />
  <link href="" rel="alternate" type="application/rss+xml" title="Kabads. Musings, mutterings and murmerings." />
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/hc.css" rel="stylesheet">
  <link href="//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet">
  
    
    </head>
    <body>
<div class="nav-toggle"><i class="fa fa-bars fa-2x"></i> Herring Cove </div>
      <div id = "wrapper">


<div class="navbar navbar-default" role="navigation">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a href="/"><p class="navbar-brand">Kabads. Musings, mutterings and murmerings.</p></a>
        </div>
        <div class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
					
					
          </ul>
        </div>
      </div>
    </div>



       
       <div id="sidebar-wrapper">
        <ul class="sidebar-nav">
					<img src="" />
          <li class="sidebar-brand"><a href="/"><h1 class="brand">Kabads. Musings, mutterings and murmerings.</h1></a><h3></h3></li>
          <hr />
					
          <hr />
          <div id="social-wrapper">
           
           
           
           
         </div>
       </ul>
     </div>



     <div class="container">


  <div id="article">
   <div class="article-title">SELinux Users, Roles, and Types</div>
   <p class="meta"><small>&nbsp;<i class="fa fa-calendar-o"></i> 2020-01-03</small></p> <hr/>
   <div class="post">
     <p>SELinux contexts follow the SELinux user:role:type:level syntax.</p>
<h3 id="users">Users</h3>
<p>Users can be seen with the command:</p>
<pre><code>semanage user -l
</code></pre>
<p>This will show the list of SELinux users, and is mapped to Linux users. If a Linux user is not listed then they are associated with the <code>__default__</code> SELinux user and inherit those rights.</p>
<h3 id="roles">Roles</h3>
<p>Role based access control is a go-between from the user to the domain. By assigning roles, a user can access particular domains. This determines which domains can be accessed by the SELinux user. The role dictates what domains (types, or contexts) it is possible to be in.</p>
<p>To find out which domains (roles) a user is approved for:</p>
<pre><code>seinfo -ruser_r -x 
</code></pre>
<p>Users can switch roles if they want. However, they can only do this if their SELinux is allowed to be in that role. You can check if this is allowed with:</p>
<pre><code>semanage user -l
</code></pre>
<p>This will list a user and the roles that they are allowed to switch to. Obviously for this to work, the Linux user has to have the corresponding SELinux username when they issue <code>id -Z</code>.</p>
<h3 id="type">Type</h3>
<p>The type is an attribute of Type Enforcement. The type defines a domain for processes, and a type for files. SELinux policy rules define how types can access each other, whether it be a domain accessing type, or a domain accessing another domain. Usually types are defined by the suffix <code>_t</code>. Rather than have many many rules which identify the access between actor and object (e.g. user and file), SELinux has a label attached to each actor and object, which specifies whether the actor is allowed access to the object. The rule specifies if the actor has a label that allows access to the objects (with that label).</p>
<h3 id="domains">Domains</h3>
<p>In SELinux labels assigned to a process is also called a <code>domain</code>. An example of an SELinux domain is <code>system_u:system_r:named_t</code>, although that is often reduced to just the type-part, i.e. <code>named_t</code>.</p>
<h3 id="conclusion">Conclusion</h3>
<p>This table represents the structure of a label:</p>
<p><code>system_u:object_r:lib_t</code> associates with an actor <code>user_u:user_r:user_t</code> in the following way:</p>
<p>| <code>system_u</code> |:| <code>object_r</code>|:| <code>lib_t</code> |
|&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;
| SELinux User|:| SELinux Role|:| SELinux Type
|&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&ndash;
| <code>user_u</code> |:| <code>user_r</code>|:| <code>user_t</code></p>

   </div>
 </div>


 <a href="https://twitter.com/share" class="twitter-share-button " data-size="small" data-count="none">Tweet</a>
 <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>

 <ul class="pager">
      &nbsp;<li class="previous"><a href="/post/2019-12-30-setting-acl-linux-filesystem/"> Setting Filesystem ACLs on Linux</a></li>
      &nbsp;<li class="next"><a href="/post/2020-03-19-rsyslog-listening-to-socket/"> Rsyslog configured to monitor journald /run/systemd/journal/syslog socket</a></li>
</ul>



    </ul>
    </div>
    <footer>

        <p class="text-muted credit">&copy; 2021. All rights reserved. </p>
    </footer>
 
    <script src="/js/jquery-1.10.2.min.js"></script>
    <script src="/js/bootstrap.min.js"></script>
    <script src="/js/bootstrap.js"></script>
    <script type="text/javascript" src="/js/hc.js"></script>
</body>

</html>

